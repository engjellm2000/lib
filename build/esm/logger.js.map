{"version":3,"file":"logger.js","names":["winston","ElasticsearchTransport","esTransformer","logData","_extends","message","level","timestamp","meta","winstonLogger","elasticsearchNode","name","options","console","handleExceptions","json","colorize","elasticsearch","transformer","clientOpts","node","log","maxRetries","requestTimeout","sniffOnStart","apm","esTransport","logger","createLogger","exitOnError","defaultMeta","service","transports","Console"],"sources":["../../src/logger.ts"],"sourcesContent":["import winston, { Logger } from 'winston';\r\nimport { ElasticsearchTransport, LogData } from 'winston-elasticsearch';\r\n\r\n// Custom transformer function\r\nconst esTransformer = (logData: LogData) => {\r\n  // Customize this to match the expected structure for Elasticsearch\r\n  return {\r\n    message: logData.message,\r\n    level: logData.level,\r\n    timestamp: logData.timestamp,\r\n    // Add any additional fields you need\r\n    ...logData.meta,\r\n  };\r\n};\r\n\r\nexport const winstonLogger = (elasticsearchNode: string, name: string, level: string): Logger => {\r\n  const options = {\r\n    console: {\r\n      level,\r\n      handleExceptions: true,\r\n      json: false,\r\n      colorize: true,\r\n    },\r\n    elasticsearch: {\r\n      level,\r\n      transformer: esTransformer,  // Use the custom transformer\r\n      clientOpts: {\r\n        node: elasticsearchNode,\r\n        log: level,\r\n        maxRetries: 2,\r\n        requestTimeout: 10000,\r\n        sniffOnStart: false,\r\n      },\r\n      apm: {},  // Required, can be an empty object if not using APM\r\n    },\r\n  };\r\n\r\n  const esTransport = new ElasticsearchTransport(options.elasticsearch);\r\n  const logger: Logger = winston.createLogger({\r\n    exitOnError: false,\r\n    defaultMeta: { service: name },\r\n    transports: [\r\n      new winston.transports.Console(options.console),\r\n      esTransport,\r\n    ],\r\n  });\r\n\r\n  return logger;\r\n}\r\n"],"mappings":";AAAA,OAAOA,OAAO,MAAkB,SAAS;AACzC,SAASC,sBAAsB,QAAiB,uBAAuB;;AAEvE;AACA,MAAMC,aAAa,GAAIC,OAAgB,IAAK;EAC1C;EACA,OAAAC,QAAA;IACEC,OAAO,EAAEF,OAAO,CAACE,OAAO;IACxBC,KAAK,EAAEH,OAAO,CAACG,KAAK;IACpBC,SAAS,EAAEJ,OAAO,CAACI;EAAS,GAEzBJ,OAAO,CAACK,IAAI;AAEnB,CAAC;AAED,OAAO,MAAMC,aAAa,GAAGA,CAACC,iBAAyB,EAAEC,IAAY,EAAEL,KAAa,KAAa;EAC/F,MAAMM,OAAO,GAAG;IACdC,OAAO,EAAE;MACPP,KAAK;MACLQ,gBAAgB,EAAE,IAAI;MACtBC,IAAI,EAAE,KAAK;MACXC,QAAQ,EAAE;IACZ,CAAC;IACDC,aAAa,EAAE;MACbX,KAAK;MACLY,WAAW,EAAEhB,aAAa;MAAG;MAC7BiB,UAAU,EAAE;QACVC,IAAI,EAAEV,iBAAiB;QACvBW,GAAG,EAAEf,KAAK;QACVgB,UAAU,EAAE,CAAC;QACbC,cAAc,EAAE,KAAK;QACrBC,YAAY,EAAE;MAChB,CAAC;MACDC,GAAG,EAAE,CAAC,CAAC,CAAG;IACZ;EACF,CAAC;EAED,MAAMC,WAAW,GAAG,IAAIzB,sBAAsB,CAACW,OAAO,CAACK,aAAa,CAAC;EACrE,MAAMU,MAAc,GAAG3B,OAAO,CAAC4B,YAAY,CAAC;IAC1CC,WAAW,EAAE,KAAK;IAClBC,WAAW,EAAE;MAAEC,OAAO,EAAEpB;IAAK,CAAC;IAC9BqB,UAAU,EAAE,CACV,IAAIhC,OAAO,CAACgC,UAAU,CAACC,OAAO,CAACrB,OAAO,CAACC,OAAO,CAAC,EAC/Ca,WAAW;EAEf,CAAC,CAAC;EAEF,OAAOC,MAAM;AACf,CAAC","ignoreList":[]}